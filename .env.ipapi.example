# IP-API Configuration for CrowdEval Location Blocking
# 
# IP-API is a free geolocation service with the following limits:
# - Free tier: 1,000 requests/month, 45 requests/minute
# - No API key required for HTTP requests
# - Pro tier: HTTPS, higher limits, and premium features
#
# Official website: https://ip-api.com/

# =============================================================================
# BASIC IP-API CONFIGURATION
# =============================================================================

# Enable location-based blocking
NEXT_PUBLIC_LOCATION_BLOCKING_ENABLED=true

# IP-API specific settings
# Set to true if you have an IP-API Pro subscription for HTTPS
IPAPI_USE_HTTPS=false

# IP-API Pro API key (optional, for Pro features)
# Get your key from: https://members.ip-api.com/
IPAPI_KEY=

# =============================================================================
# BLOCKING CONFIGURATION
# =============================================================================

# Countries to block (ISO 3166-1 alpha-2 codes)
# Common high-risk countries for security
BLOCKED_COUNTRIES=CN,RU,KP,IR,SY,VE,MM,AF

# Blocked regions/states (optional)
BLOCKED_REGIONS=

# Risk threshold (0-100) - block if risk score exceeds this
# IP-API provides proxy/hosting detection which greatly improves accuracy
RISK_THRESHOLD=70

# =============================================================================
# VPN/PROXY DETECTION
# =============================================================================

# Use IP-API's built-in proxy detection (recommended)
BLOCK_VPN=true
BLOCK_PROXY=true

# Block hosting/datacenter IPs (IP-API provides this data)
BLOCK_DATACENTER=true

# =============================================================================
# WHITELIST CONFIGURATION
# =============================================================================

# IP addresses that are always allowed (comma-separated)
WHITELIST_IPS=127.0.0.1,::1

# CIDR blocks that are always allowed (comma-separated)
WHITELIST_CIDRS=192.168.0.0/16,10.0.0.0/8,172.16.0.0/12

# =============================================================================
# FAIL-SAFE CONFIGURATION
# =============================================================================

# Fail-open mode: allow access when geolocation fails
# IMPORTANT: Set to true for production to avoid blocking legitimate users
FAIL_OPEN=true

# =============================================================================
# TIME-BASED RESTRICTIONS (OPTIONAL)
# =============================================================================

# Enable time-based blocking
TIME_BASED_BLOCKING=false

# Timezone for time restrictions
BLOCKING_TIMEZONE=UTC

# Allowed hours (24-hour format)
ALLOWED_HOURS_START=9
ALLOWED_HOURS_END=17

# =============================================================================
# LOGGING AND MONITORING
# =============================================================================

# Enable detailed location event logging
LOG_LOCATION_EVENTS=true

# Log level (debug, info, warn, error)
LOG_LEVEL=info

# Support email for blocked users
SUPPORT_EMAIL=support@crowdeval.com

# =============================================================================
# RATE LIMITING
# =============================================================================

# Rate limiting for authentication endpoints (requests per minute)
AUTH_RATE_LIMIT=5

# Rate limiting window (minutes)
AUTH_RATE_WINDOW=1

# =============================================================================
# CACHING (OPTIONAL)
# =============================================================================

# Cache geolocation results to reduce API calls
CACHE_GEOLOCATION=true

# Cache duration in seconds (default: 1 hour)
GEOLOCATION_CACHE_TTL=3600

# =============================================================================
# DEVELOPMENT/TESTING
# =============================================================================

# Skip location checks for development (set to false in production)
SKIP_LOCATION_CHECK_DEV=false

# Test mode: log but don't block (useful for testing configuration)
LOCATION_TEST_MODE=false

# =============================================================================
# IP-API UPGRADE RECOMMENDATIONS
# =============================================================================
#
# Consider upgrading to IP-API Pro if you need:
# - HTTPS requests for better security
# - Higher rate limits (up to 150,000 requests/month)
# - Commercial use license
# - Premium support
#
# Pro pricing: https://ip-api.com/docs/pricing
# 
# Basic Pro plan: $13/month for 150,000 requests
# Pro+ plan: $25/month for 500,000 requests
#
# =============================================================================

# Example configuration for different environments:

# DEVELOPMENT
# NEXT_PUBLIC_LOCATION_BLOCKING_ENABLED=false
# SKIP_LOCATION_CHECK_DEV=true
# LOCATION_TEST_MODE=true

# STAGING
# NEXT_PUBLIC_LOCATION_BLOCKING_ENABLED=true
# LOCATION_TEST_MODE=true
# FAIL_OPEN=true

# PRODUCTION
# NEXT_PUBLIC_LOCATION_BLOCKING_ENABLED=true
# LOCATION_TEST_MODE=false
# FAIL_OPEN=true
# LOG_LEVEL=warn
